Debug: Rule YAML content:
==================================================
title: Persistence Via Sudoers Files
id: ddb26b76-4447-4807-871f-1b035b2bfa5d
status: test
description: Detects creation of sudoers file or files in "sudoers.d" directory which can be used a potential method to persiste privileges for a specific user.
references:
    - https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/apps/deployer.sh
author: Nasreddine Bencherchali (Nextron Systems)
date: 2022-07-05
modified: 2022-12-31
tags:
    - attack.persistence
    - attack.t1053.003
logsource:
    product: linux
    category: file_event
detection:
    selection:
        TargetFilename|startswith: '/etc/sudoers.d/'
    condition: selection
falsepositives:
    - Creation of legitimate files in sudoers.d folder part of administrator work
level: medium

==================================================
Rule loaded successfully.
Debug: Rule title: Persistence Via Sudoers Files
Debug: Rule logsource: SigmaLogSource(category='file_event', product='linux', service=None, definition=None, source=None, custom_attributes=None)
Debug: Detection type: <class 'sigma.rule.SigmaDetections'>
Debug: Detection attributes: ['condition', 'detections', 'from_dict', 'parsed_condition', 'source', 'to_dict']
Debug: detections: {'selection': SigmaDetection(parent=None, detection_items=[SigmaDetectionItem(parent=None, applied_processing_items=set(), field='TargetFilename', modifiers=[<class 'sigma.modifiers.SigmaStartswithModifier'>], value=[SigmaString(('/etc/sudoers.d/', <SpecialChars.WILDCARD_MULTI: 1>))], value_linking=<class 'sigma.conditions.ConditionOR'>, source=None)], source=None, item_linking=<class 'sigma.conditions.ConditionAND'>)}
Debug: parsed_condition type: <class 'list'>
Debug: parsed_condition is a list with 1 items:
  [0]: <class 'sigma.conditions.SigmaCondition'> - SigmaCondition(applied_processing_items=set(), condition='selection', detections=SigmaDetections(detections={'selection': SigmaDetection(parent=None, detection_items=[SigmaDetectionItem(parent=None, applied_processing_items=set(), field='TargetFilename', modifiers=[<class 'sigma.modifiers.SigmaStartswithModifier'>], value=[SigmaString(('/etc/sudoers.d/', <SpecialChars.WILDCARD_MULTI: 1>))], value_linking=<class 'sigma.conditions.ConditionOR'>, source=None)], source=None, item_linking=<class 'sigma.conditions.ConditionAND'>)}, condition=['selection'], source=None), source=None)